package io.tomahawkd.tlstester.tlsattacker;

import de.rub.nds.tlsattacker.attacks.config.AttackConfig;
import de.rub.nds.tlsattacker.core.config.Config;
import de.rub.nds.tlsattacker.core.config.delegate.ClientDelegate;
import io.tomahawkd.tlstester.InternalNamespaces;
import io.tomahawkd.tlstester.data.TargetInfo;

public abstract class VulnerabilityTester {

	protected Config initConfig(TargetInfo host, AttackConfig attackConfig) {

		ClientDelegate delegate = (ClientDelegate) attackConfig.getDelegate(ClientDelegate.class);
		delegate.setHost(host.getHost());

		Config config = attackConfig.createConfig();
		delegate.applyDelegate(config);

		String protocol = (String)
				host.getCollectedData().get(InternalNamespaces.Data.STARTTLS);
		if (protocol != null) {
			TesterHelper.setStarttlsProtocol(config, protocol);
		}

		return config;
	}

	public abstract boolean test(TargetInfo host);
}
